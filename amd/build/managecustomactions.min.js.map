{"version":3,"file":"managecustomactions.min.js","sources":["../src/managecustomactions.js"],"sourcesContent":["/**\n * Module to handle js on webhooks page in local trigger.\n *\n * @package local_trigger\n * @author Justin Hunt - justin@poodll.com\n */\ndefine(['jquery', 'core/ajax', 'core/str', 'core/log'], function($, ajax, str,log) {\n    const SELECTOR = {\n        CA_SELECTBOX: '.local_trigger_ca_selectbox select',\n        CA_DESCRIPTION: '#fitem_id_description input',\n        CA_PROTOCOL: '#fitem_id_protocol  input',\n        CA_CUSTOMTEXT1: '#fitem_id_customtext1 input',\n        CA_CUSTOMTEXT2: '#fitem_id_customtext2 input',\n        CA_CUSTOMTEXT3: '#fitem_id_customtext3 input',\n        CA_CUSTOMTEXT4: '#fitem_id_customtext4 input',\n        CA_CUSTOMTEXT5: '#fitem_id_customtext5 input',\n        CA_CUSTOMTEXT6: '#fitem_id_customtext6 input',\n        CA_CUSTOMTEXT7: '#fitem_id_customtext7 input',\n        CA_CUSTOMTEXT8: '#fitem_id_customtext8 input',\n        CA_CUSTOMTEXT9: '#fitem_id_customtext9 input',\n        CA_CUSTOMTEXT10: '#fitem_id_customtext10 input',\n    }\n\n    const EVENT = {\n        CHANGE: 'change',\n    }\n\n    var stringStore = {};\n\n    const initStrings = function (callback) {\n        str.get_strings([\n            {key: \"webhooks_explanation\", component: \"local_trigger\"},\n            {key: \"customactions_explanation\", component: \"local_trigger\"},\n        ]).done(function (strings) {\n            log.debug(strings);\n            stringStore = strings;\n            if (typeof callback == 'function') {\n                callback();\n            }\n        });\n    };\n\n    const clearFields = function() {\n        $(SELECTOR.CA_DESCRIPTION).val('');\n        $(SELECTOR.CA_PROTOCOL).val('');\n        $(SELECTOR.CA_CUSTOMTEXT1).val('');\n        $(SELECTOR.CA_CUSTOMTEXT2).val('');\n        $(SELECTOR.CA_CUSTOMTEXT3).val('');\n        $(SELECTOR.CA_CUSTOMTEXT4).val('');\n        $(SELECTOR.CA_CUSTOMTEXT5).val('');\n        $(SELECTOR.CA_CUSTOMTEXT6).val('');\n        $(SELECTOR.CA_CUSTOMTEXT7).val('');\n        $(SELECTOR.CA_CUSTOMTEXT8).val('');\n        $(SELECTOR.CA_CUSTOMTEXT9).val('');\n        $(SELECTOR.CA_CUSTOMTEXT10).val('');\n        for(var i=1;i<=10;i++) {\n            $('#customtext' + i + '_label').text('');\n        }\n    }\n\n\n    const initListeners = function() {\n        var that = this;\n\n        $(SELECTOR.CA_SELECTBOX).on(EVENT.CHANGE, function (e) {\n            log.debug(\"changed\");\n            log.debug($(this).val());\n\n            //clear fields\n            clearFields();\n\n            ajax.call([{\n                methodname: 'local_trigger_fetch_function_details',\n                args: {\n                    functionname: $(this).val()\n                }\n            }])[0].done(function (data) {\n                var fdata = JSON.parse(data);\n                $(SELECTOR.CA_DESCRIPTION).val(fdata.description);\n                var index=0;\n                //do required fields first\n                for(var fieldname in fdata.parameters_desc.keys) {\n                    var thefield = fdata.parameters_desc.keys[fieldname];\n                    if(thefield.required) {\n                        index++;\n                        $(SELECTOR['CA_CUSTOMTEXT' + (index)]).val(fieldname);\n                        $('#customtext' + index + '_label').text('(' + thefield.type + ') ' + thefield.desc + ' (required)');\n                    }\n                }\n                //do optional fields next\n                for(var fieldname in fdata.parameters_desc.keys) {\n                    var thefield = fdata.parameters_desc.keys[fieldname];\n                    if(!thefield.required) {\n                        index++;\n                        $(SELECTOR['CA_CUSTOMTEXT' + (index)]).val(fieldname);\n                        $('#customtext' + index + '_label').text('(' + thefield.type + ') ' + thefield.desc + ' (optional)');\n                    }\n                }\n\n                log.debug(data);\n            });\n        });\n    };\n\n    return {\n        init: function () {\n                initStrings();\n                initListeners();\n        }\n    }\n});"],"names":["define","$","ajax","str","log","SELECTOR","CA_SELECTBOX","CA_DESCRIPTION","CA_PROTOCOL","CA_CUSTOMTEXT1","CA_CUSTOMTEXT2","CA_CUSTOMTEXT3","CA_CUSTOMTEXT4","CA_CUSTOMTEXT5","CA_CUSTOMTEXT6","CA_CUSTOMTEXT7","CA_CUSTOMTEXT8","CA_CUSTOMTEXT9","CA_CUSTOMTEXT10","EVENT","initListeners","on","e","debug","this","val","i","text","clearFields","call","methodname","args","functionname","done","data","fdata","JSON","parse","description","index","fieldname","parameters_desc","keys","thefield","required","type","desc","init","callback","get_strings","key","component","strings"],"mappings":"AAMAA,2CAAO,CAAC,SAAU,YAAa,WAAY,aAAa,SAASC,EAAGC,KAAMC,IAAIC,WACpEC,SAAW,CACbC,aAAc,qCACdC,eAAgB,8BAChBC,YAAa,4BACbC,eAAgB,8BAChBC,eAAgB,8BAChBC,eAAgB,8BAChBC,eAAgB,8BAChBC,eAAgB,8BAChBC,eAAgB,8BAChBC,eAAgB,8BAChBC,eAAgB,8BAChBC,eAAgB,8BAChBC,gBAAiB,gCAGfC,aACM,eAqCNC,cAAgB,WAGlBnB,EAAEI,SAASC,cAAce,GAAGF,cAAc,SAAUG,GAChDlB,IAAImB,MAAM,WACVnB,IAAImB,MAAMtB,EAAEuB,MAAMC,OAxBN,WAChBxB,EAAEI,SAASE,gBAAgBkB,IAAI,IAC/BxB,EAAEI,SAASG,aAAaiB,IAAI,IAC5BxB,EAAEI,SAASI,gBAAgBgB,IAAI,IAC/BxB,EAAEI,SAASK,gBAAgBe,IAAI,IAC/BxB,EAAEI,SAASM,gBAAgBc,IAAI,IAC/BxB,EAAEI,SAASO,gBAAgBa,IAAI,IAC/BxB,EAAEI,SAASQ,gBAAgBY,IAAI,IAC/BxB,EAAEI,SAASS,gBAAgBW,IAAI,IAC/BxB,EAAEI,SAASU,gBAAgBU,IAAI,IAC/BxB,EAAEI,SAASW,gBAAgBS,IAAI,IAC/BxB,EAAEI,SAASY,gBAAgBQ,IAAI,IAC/BxB,EAAEI,SAASa,iBAAiBO,IAAI,QAC5B,IAAIC,EAAE,EAAEA,GAAG,GAAGA,IACdzB,EAAE,cAAgByB,EAAI,UAAUC,KAAK,IAarCC,GAEA1B,KAAK2B,KAAK,CAAC,CACPC,WAAY,uCACZC,KAAM,CACFC,aAAc/B,EAAEuB,MAAMC,UAE1B,GAAGQ,MAAK,SAAUC,UACdC,MAAQC,KAAKC,MAAMH,MACvBjC,EAAEI,SAASE,gBAAgBkB,IAAIU,MAAMG,iBACjCC,MAAM,MAEN,IAAIC,aAAaL,MAAMM,gBAAgBC,KAAM,EACzCC,SAAWR,MAAMM,gBAAgBC,KAAKF,YAC9BI,WACRL,QACAtC,EAAEI,SAAS,gBAAmBkC,QAASd,IAAIe,WAC3CvC,EAAE,cAAgBsC,MAAQ,UAAUZ,KAAK,IAAMgB,SAASE,KAAO,KAAOF,SAASG,KAAO,oBAI1F,IAAIN,aAAaL,MAAMM,gBAAgBC,KAAM,KACzCC,UAAAA,SAAWR,MAAMM,gBAAgBC,KAAKF,YAC7BI,WACTL,QACAtC,EAAEI,SAAS,gBAAmBkC,QAASd,IAAIe,WAC3CvC,EAAE,cAAgBsC,MAAQ,UAAUZ,KAAK,IAAMgB,SAASE,KAAO,KAAOF,SAASG,KAAO,gBAI9F1C,IAAImB,MAAMW,mBAKf,CACHa,KAAM,WA5EU,IAAUC,SAC1B7C,IAAI8C,YAAY,CACZ,CAACC,IAAK,uBAAwBC,UAAW,iBACzC,CAACD,IAAK,4BAA6BC,UAAW,mBAC/ClB,MAAK,SAAUmB,SACdhD,IAAImB,MAAM6B,SACIA,QACS,mBAAZJ,UACPA,cAsEA5B"}